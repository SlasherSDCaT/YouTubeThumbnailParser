# YouTube Thumbnail Proxy Service

## Описание задания

Данный проект представляет собой gRPC прокси-сервис для загрузки превью (thumbnail) видеороликов с YouTube. Сервис кэширует загруженные превью в SQLite базе данных, что позволяет при повторном запросе на тот же видеоролик отдать кэшированный ответ. Клиентская часть реализована в виде утилиты командной строки, которая позволяет передавать ссылки на видеоролики и получать соответствующие превью. Утилита поддерживает асинхронное скачивание превью, что ускоряет обработку большого количества запросов.

## Инструкции по запуску

### Клонирование проекта

Сначала необходимо клонировать проект из репозитория. Выполните следующую команду:

```bash
git clone https://gitlab.com/SlasherSDCaT/youtubeparser.git
cd youtubeparser
```

### Установка зависимостей

Убедитесь, что у вас установлен Go (версии 1.16 и выше). Загрузите необходимые зависимости, выполнив команду:

```bash
go mod tidy
```

### Настройка конфигурации

Создайте файл `config.yaml` в корневом каталоге проекта с содержимым:

```yaml
youtube_api_key: "YOUR_YOUTUBE_API_KEY"
cache_db_path: "./thumbnails_cache.db"
```

Замените `YOUR_YOUTUBE_API_KEY` на свой ключ API, полученный из Google Cloud Console (инструкции ниже).

### Как получить YouTube API Key

YouTube API Key можно получить, зарегистрировавшись в **Google Cloud Console** и активировав API. Вот пошаговая инструкция:

1. **Перейдите в [Google Cloud Console](https://console.cloud.google.com/)**. Вам потребуется учетная запись Google.
2. **Создайте новый проект** (или выберите существующий).
3. Перейдите в раздел **APIs & Services** > **Library** и найдите **YouTube Data API v3**.
4. **Активируйте YouTube Data API v3** для проекта.
5. После активации API перейдите в **Credentials** и нажмите **Create Credentials**.
6. Выберите **API key** в качестве типа учетных данных.
7. Скопируйте сгенерированный ключ API и вставьте его в `config.yaml` вместо `YOUR_YOUTUBE_API_KEY`.

Теперь ваш ключ API будет готов к использованию для запросов к YouTube API.


### Запуск сервиса

Запустите gRPC сервер с помощью следующей команды:

```bash
go run ./internal/server
```

Сервер будет запущен на порту `50051`.

### Использование клиентской утилиты

Для запуска клиентской утилиты используйте следующую команду:

```bash
go run ./cmd/client [FLAGS] [URL1 URL2 ...]
```

## Инструкции по сборке и запуску

Если вы хотите собрать проект в исполняемый файл, используйте следующую команду:

```bash
go build -o youtube-thumbnail-client ./cmd/client
```

Для запуска собранной клиентской утилиты выполните:

```bash
./youtube-thumbnail-client [FLAGS] [URL1 URL2 ...]
```

## Использование

### Примеры запросов

- Скачивание превью для одного видео:

```bash
go run ./cmd/client https://youtube.com/watch?v=example1
```

- Асинхронное скачивание превью для нескольких видео:

```bash
go run ./cmd/client --async https://youtube.com/watch?v=example1 https://youtube.com/watch?v=example2
```

- Проверка доступности сервера:

```bash
go run ./cmd/client --srvcheck
```

- Скачивание превью из файла со списком URL:

```bash
go run ./cmd/client --file urls.txt
```

### Доступные флаги

- `--help` или вызов без аргументов и флагов - краткая справка по использованию программы
- `--async` - позволяет асинхронно скачивать превью.
- `--srvcheck` - проверяет доступность gRPC сервера.
- `--file` - путь к файлу, содержащему список URL видеороликов.

## Тестирование

Для проведения тестирования проекта выполните следующую команду:

```bash
go test -cover -coverpkg=./internal/... ./tests/...
```

Это запустит тесты и покажет покрытие кода.

## Заключение

Этот проект предоставляет эффективное решение для получения и кэширования превью видеороликов с YouTube с использованием gRPC и SQLite. Вы можете легко расширить функциональность или интегрировать его в более крупные приложения.